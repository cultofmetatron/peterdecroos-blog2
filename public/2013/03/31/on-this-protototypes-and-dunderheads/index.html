<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>On this, protototypes, and dunderheads | Console.blog(this.thought)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Of all the stranger than fiction things I have seen, I can’t say I have experienced as blatant a miscarriage of conceptual understanding as I have with javascript’s object system. (Ok, I might be exag">
<meta property="og:type" content="article">
<meta property="og:title" content="On this, protototypes, and dunderheads">
<meta property="og:url" content="http://yoursite.com/2013/03/31/on-this-protototypes-and-dunderheads/">
<meta property="og:site_name" content="Console.blog(this.thought)">
<meta property="og:description" content="Of all the stranger than fiction things I have seen, I can’t say I have experienced as blatant a miscarriage of conceptual understanding as I have with javascript’s object system. (Ok, I might be exag">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="On this, protototypes, and dunderheads">
<meta name="twitter:description" content="Of all the stranger than fiction things I have seen, I can’t say I have experienced as blatant a miscarriage of conceptual understanding as I have with javascript’s object system. (Ok, I might be exag">

  
    <link rel="alternative" href="/atom.xml" title="Console.blog(this.thought)" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link href="http://fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css">

  <link rel="stylesheet" href="/css/bootstrap.min.css" type="text/css">

  <link rel="stylesheet" href="/css/style.css" type="text/css">

  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">Console.blog(this.thought)</a>
    <div class="collapse navbar-collapse nav-menu">
      <ul class="nav navbar-nav">
      
        <li>
          <a href="/archives">
            <i class="fa fa-archive"></i>
            Archives
          </a>
        </li>
      
        <li>
          <a href="/categories">
            <i class="fa fa-folder"></i>
            Categories
          </a>
        </li>
      
        <li>
          <a href="/tags">
            <i class="fa fa-tags"></i>
            Tags
          </a>
        </li>
      
        <li>
          <a href="/wiki">
            <i class="fa fa-book"></i>
            Wiki
          </a>
        </li>
      
        <li>
          <a href="/about">
            <i class="fa fa-user"></i>
            About
          </a>
        </li>
      
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
          <li><a id="rss-link" href="/atom.xml" title="RSS Feed"><i class="fa fa-rss"></i></a></li>
        
      </ul>
    </div>
  </div>
</nav>
<div class="clearfix"></div>

      <div id='content' class="container">

        <div class="page-header-wrapper">
          <!--[if lt IE 9]><div class="alert alert-warning alert-dismissable"><button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button><strong>提示:</strong>您的浏览器版本太低了,建议升级到 <strong><a href="http://windows.microsoft.com/zh-cn/internet-explorer/download-ie" title="IE9">IE9</a></strong> 以上,本站使用<a href="https://www.google.com/intl/zh-CN/chrome/">Chrome浏览器</a>可以获得最好的显示效果.</div><![endif]-->
          <div class="page-header">
            <h1 class="title">
          
            On this, protototypes, and dunderheads
          
            </h1>
        </div>
      </div>
      
      <section id="main"
        
      ><article id="post-nd6jnv80vtzk5f5r" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-inner">
    

    
    <div class="article-entry" itemprop="articleBody">
      
        <div id="toc"><span class="toc-header">Contents</span><ol class="article-toc"><li class="article-toc-item article-toc-level-3"><a class="article-toc-link" href="#On_“this”"><span class="article-toc-text">On “this”</span></a></li><li class="article-toc-item article-toc-level-3"><a class="article-toc-link" href="#on_proto_and_prototype"><span class="article-toc-text">on proto and prototype</span></a></li><li class="article-toc-item article-toc-level-3"><a class="article-toc-link" href="#The_proto_Attribute"><span class="article-toc-text">The proto Attribute</span></a><ol class="article-toc-child"><li class="article-toc-item article-toc-level-4"><a class="article-toc-link" href="#This_begs_the_question?_why_doesn’t_this_work?"><span class="article-toc-text">This begs the question? why doesn’t this work?</span></a></li><li class="article-toc-item article-toc-level-4"><a class="article-toc-link" href="#Actually_it_DOES,_But_only_in_V8_-_ie:_chrome_and_node-js"><span class="article-toc-text">Actually it DOES, But only in V8 - ie: chrome and node.js</span></a></li></ol></li><li class="article-toc-item article-toc-level-3"><a class="article-toc-link" href="#call()_and_apply()"><span class="article-toc-text">call() and apply()</span></a></li></ol></div><p>Of all the stranger than fiction things I have seen, I can’t say I have experienced as blatant a miscarriage of conceptual understanding as I have with javascript’s object system. (Ok, I might be exagerating just a little…)</p>
<p>Javascript is an interesting language. It is quite powerful when paired with appropriate libraries like <a href="http://underscorejs.org/" target="_blank" rel="external">underscore</a>. Its prototypical inheritence model is a mindblowlingly powerful reductionist critique of classical inheritance. In the right hands, functions become lego pieces that can be glued onto objects in staggeringly flexible ways.</p>
<h3 id="On_“this”">On “this”</h3>
<p>Lets take an object</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> myObject = {};</div></pre></td></tr></table></figure>

<p>This is a basic object. It is also a hash.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//We can access it via dot notation or hash notation</span></div><div class="line">myObject[<span class="string">'jackson'</span>] = <span class="number">5</span>;</div><div class="line"><span class="number">5</span> + myObject[<span class="string">'jackson'</span>]; <span class="comment">// =&gt; 10;</span></div><div class="line"><span class="number">5</span> + myObject.jackson;    <span class="comment">// =&gt; 10;</span></div><div class="line"></div><div class="line"><span class="comment">//we can store strings, numbers, other objects and very importantly,</span></div><div class="line"><span class="comment">// other functions!</span></div><div class="line">myObject.title = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{</div><div class="line">  <span class="keyword">return</span> <span class="string">"this is the Jackson "</span> + <span class="keyword">this</span>.jackson;</div><div class="line">}</div><div class="line"></div><div class="line">myObject.title() <span class="comment">// =&gt; "this is the Jackson 5";</span></div></pre></td></tr></table></figure>

<p>If you are currently a javascript programmer, you’ve probably seen code like this. In langages like Java, or c, Functions are simply routines that operate on code. they are static. Once they exist, they exist in only one context. The Java version of <em>‘this’</em> refers to the instance of the instantiated object.</p>
<p>Functions in javascript are “First Class.” This is a really important distinction to make because it enables all of the most powerful code reuse techniques. A function can exist beyond an object. It can be made an instance function a several different objects. In practice, it means we can assign functions to variables and pass it into functions as arguments. We can even return functions from other functions.</p>
<p>Put more succinctly…</p>
<p>We can create a function which performs operations related to an abstract “this” attribute without knowing what “this” is going to be till we hook up a context to it when its called.</p>
<p>It is important to discuss the notion of call time. Languages where functions are not first class do not have a call time.</p>
<p>Lets take a cannonical example in Java.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleClass</span> </span>{</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keyword">int</span> foo;</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span>(String[] args) {</div><div class="line">      System.out.println(<span class="string">"Clojure is way more fun"</span>);</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="keyword">public</span> <span class="title">ExampleClass</span>(<span class="keyword">int</span> foo) {</div><div class="line">      <span class="comment">// initialize code goes here</span></div><div class="line">      <span class="keyword">this</span>.foo = foo;</div><div class="line">  }</div><div class="line">  <span class="keyword">public</span> <span class="title">getFoo</span>() {</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.foo;</div><div class="line">  }</div><div class="line">}</div></pre></td></tr></table></figure>

<p>Java functions are not first class. The <em>‘this’</em> refers only to the instantiated instance of this class. If I instantiate this class and call the function, I will get the class variable “foo” of the instance.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">ExampleClass exampleClass = <span class="keyword">new</span> ExampleClass(<span class="number">5</span>); <span class="comment">// Java is ridiculous!!! exampleClass.getFoo(); // =&gt; 5</span></div><div class="line"></div><div class="line"><span class="comment">// this results in an error because there is no public variable getFoo exampleClass.getFoo;</span></div></pre></td></tr></table></figure>

<p>Because Java’s functions are not first class, there is no notion of this function being referred to unless its being specifically called. Javascript’s functions are dfferent. I can declare a javascript function and bind it to several objects.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> getFoo = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{ <span class="keyword">return</span> <span class="keyword">this</span>.foo; };</div><div class="line"></div><div class="line"><span class="keyword">var</span> first = { foo:<span class="number">1</span> }; first.getFoo = getFoo;</div><div class="line"></div><div class="line"><span class="keyword">var</span> second = { foo: <span class="number">2</span> }; second.getFoo = getFoo;</div><div class="line"></div><div class="line"><span class="keyword">var</span> third = {foo:<span class="number">3</span>}; third.theNameIsIrrelevant= getFoo;</div><div class="line"></div><div class="line">first.getFoo() <span class="comment">// =&gt; 1 second.getFoo() // =&gt; 2 third.theNameIsIrrelevant() // =&gt; 3</span></div></pre></td></tr></table></figure>

<p>This code in javascript works because javascript functions are variables that can be assigned and passed around like a company pen. (thats about as work safe a metaphor as I could come up with. sorry…) The only large difference between functions and other javascript types is that functions can be <em>called.</em></p>
<p>Call time is the point where the javascript function is executed. If it contains a <em>‘this’</em> inside it. That keyword then resolves to whatever object that function is being called upon. If there is no object, <em>‘this’</em> resolves to the global object. In Browsers, the global object is <em>window.</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"> <span class="built_in">window</span>.foo = <span class="string">"ramalamadingdong"</span>;</div><div class="line"></div><div class="line">getFoo(); <span class="comment">// =&gt; "ramalamadingdong"</span></div></pre></td></tr></table></figure>

<h3 id="on_proto_and_prototype">on <strong>proto</strong> and prototype</h3>
<p><em>new</em> is a feature of javascript that changes the context of <em>‘this’</em> in a constructor function. when new is called on a constructor function being called, <em>new</em> becomes an object that is being modified and eventually returned. It will delegate function calls it cannot respond to to whatever the function’s prototype attribute is. IE: functions in javasript are objects.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> dundar = { gummy:<span class="string">'bear'</span> }</div><div class="line"></div><div class="line"><span class="keyword">var</span> ContructorFunction = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{ <span class="comment">// at this point this == {}; this.foo = "bar"</span></div><div class="line"></div><div class="line"><span class="comment">// "return this" is implicit</span></div><div class="line"></div><div class="line">}</div><div class="line"></div><div class="line">ContructorFunction.prototype = dundar;</div><div class="line"></div><div class="line">newObject = <span class="keyword">new</span> ContructorFunction();</div><div class="line"></div><div class="line">newObject.gummy; <span class="comment">// =&gt; 'bear' newObject.foo; // =&gt; 'bar'</span></div></pre></td></tr></table></figure>

<h3 id="The_proto_Attribute">The <strong>proto</strong> Attribute</h3>
<p>Javascript’s prototype delegation is setup such that if an attribute is accessed on an object and the object does not have that attribute. It will defer that request to the object set as its <strong>proto</strong>. The <strong>proto</strong> is determined by the constructor function’s <em>prototype</em> attribute.</p>
<h4 id="This_begs_the_question?_why_doesn’t_this_work?">This begs the question? why doesn’t this work?</h4>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="keyword">var</span> dundar = { gummy:<span class="string">'bear'</span> }</div><div class="line"></div><div class="line">newObject = { foo: <span class="string">'bar'</span> }; newObject.**proto** = dundar;</div></pre></td></tr></table></figure>

<h4 id="Actually_it_DOES,_But_only_in_V8_-_ie:_chrome_and_node-js">Actually it DOES, But only in V8 - ie: chrome and node.js</h4>
<p>(as an interesting aside, this technique is used alot in the express source code. Don’t try this at home, unless you do server side node at home of course!)</p>
<p>Sorry to burst your bubble but I must advise you that you do not do this on the browser as it will not work becase <strong>proto</strong> is a protected attribute. Thats right, the song and dance above it using <em>new</em> is the only surefire way to assign the <strong>proto</strong> attribute.</p>
<h3 id="call()_and_apply()">call() and apply()</h3>
<p>To recap</p>
<p>Unless you call the function with new, <em>‘this’</em> becomes resolved within the function to whatever is on the left side of the ‘.’. call() and apply() can be called on any function and allow you to explicitly set what <em>‘this’</em> will resolve to. the only difference is that call takes the arguments of the function right after the new meaning of <em>‘this’</em> and apply takes the arguments as an array.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">myObject1 = { foo: <span class="string">'bar'</span>, num: <span class="number">1</span> }</div><div class="line"></div><div class="line">myObject2 = { foo: <span class="string">'manshu'</span>, getFoo : <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>{ <span class="keyword">return</span> <span class="keyword">this</span>.foo; } inc: <span class="function"><span class="keyword">function</span><span class="params">(num)</span> </span>{ <span class="keyword">this</span>.num += num; <span class="keyword">return</span> <span class="keyword">this</span>.num; } }</div><div class="line"></div><div class="line"><span class="comment">//errors out because it doesn't have a getFoo() method myObject1.getFoo();</span></div><div class="line"></div><div class="line">myObject2.getFoo() <span class="comment">// =&gt; 'manshu'</span></div><div class="line"></div><div class="line"><span class="comment">//heres where is gets interesting myObject2.getsFoo.call(myObject1) // =&gt; 'bar'</span></div><div class="line"></div><div class="line"><span class="comment">//this one errors because myObject2 does not have a num attribute myObject2.inc() // badd</span></div><div class="line"></div><div class="line">myObject2.inc.call(myObject1, <span class="number">1</span>); <span class="comment">//sets myObject1.num to 2</span></div><div class="line"></div><div class="line"><span class="comment">//apply does the same with the arguments in an array myObject2.inc.apply(myObject1, [1]); // myObject1.num is now 3!!</span></div></pre></td></tr></table></figure>

<p>Now we’re ready for how to create inheritence chains in javascript! (that article is comming soon.)</p>

      
    </div>
  </div>
</article>


</section>
        
          
<aside id="sidebar">
  
    
      
<div class="widget-wrap center">
  <ul class="pagination">
    <li>
      
        <a href="/2013/04/11/processes-in-node-introduction/" class="nav-prev">Prev</a>
      
    </li>
    <li>
      <a data-url="http://yoursite.com/2013/03/31/on-this-protototypes-and-dunderheads/" data-id="nd6jnv80vtzk5f5r" data_title="On this, protototypes, and dunderheads"
        data_summary="Of all the stranger than fiction things I have seen, I can’t say I have experienced as blatant a miscarriage of conceptual understanding as I have with javascr..." class="article-share-link">Share</a>
    </li>
    <li>
      
        <a href="/2013/02/14/quicksort/" class="nav-next">Next</a>
      
    </li>
  </ul>
</div>


    
      <div class="widget-wrap">
  <div class="post-widget">
    <i class="fa fa-clock-o"></i>
    <time datetime="2013-04-01T06:34:00.000Z" itemprop="datePublished">Mar 31 2013</time>
  </div>
</div>

    
      
  <div class="widget-wrap">
    <div class="post-widget">
      <i class="fa fa-folder"></i>
      <a class="category-link" href="/categories/Javascript-prototypes/">Javascript, prototypes<span class="category-count">1</span></a>
    </div>
  </div>


    
      
  <div class="widget-wrap">
    <div class="post-widget">
      <i class="fa fa-tags"></i>
      
    </div>
  </div>


    
  
</aside>


        
      </div>
      <footer id="footer">
  
  <div class="outer container">
    <div id="footer-info" class="inner">
      <a href="/">Console.blog(this.thought)</a> &copy; 2014 Powered by <a href="http://zespia.tw/hexo/" target="_blank">Hexo</a> and Theme by <a href="https://github.com/seff/nut" target="_blank">Nut</a>
    </div>
  </div>
</footer>
<a id="gotop" href="#">
  <i class="fa fa-chevron-up"></i>
</a>

    </div>
    <nav id="mobile-nav">
  
    <a href="[object Object]" class="mobile-nav-link">0</a>
  
    <a href="[object Object]" class="mobile-nav-link">1</a>
  
    <a href="[object Object]" class="mobile-nav-link">2</a>
  
    <a href="[object Object]" class="mobile-nav-link">3</a>
  
    <a href="[object Object]" class="mobile-nav-link">4</a>
  
</nav>

    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>

<script src="/js/jquery.fitvids.js" type="text/javascript"></script>

<script src="/js/bootstrap.min.js" type="text/javascript"></script>

<script src="/js/script.js" type="text/javascript"></script>


  </div>
</body>
</html>
